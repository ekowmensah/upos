# Deploying from GitHub to cPanel

This guide explains how to deploy the UPOS application from GitHub to cPanel, including handling folders that were not pushed to GitHub.

## Folders NOT in GitHub (Gitignored)

These folders were excluded from GitHub and need special handling:

- `/storage/` - Application storage (logs, cache, sessions)
- `/vendor/` - PHP dependencies (regenerated via Composer)
- `/node_modules/` - Node dependencies (regenerated via npm)
- `/public/uploads/` - User uploaded files (business logos, documents, images, media)
- `/public/css/`, `/public/fonts/`, `/public/images/`, `/public/modules/` - Compiled assets
- `.env` - Environment configuration file

## Deployment Steps

### Step 1: Pull from GitHub in cPanel

1. Log into cPanel at `https://e-pos.cloud:2083`
2. Go to **Git Version Control**
3. Click **Create** to add a new repository
4. Enter repository details:
   - **Clone URL**: `https://github.com/ekowmensah/upos.git`
   - **Repository Path**: `/home/cloudpos/public_html/demo` (or your desired path)
   - **Repository Name**: `upos`
5. Click **Create** to clone the repository

### Step 2: Run Setup Script

1. Open **Terminal** in cPanel
2. Navigate to your repository:
   ```bash
   cd /home/cloudpos/public_html/demo
   ```
3. Make the setup script executable and run it:
   ```bash
   chmod +x setup-cpanel.sh
   ./setup-cpanel.sh
   ```

This script will:
- Create all required storage directories
- Create upload directories
- Set proper permissions
- Install Composer dependencies
- Generate application key
- Clear caches
- Create storage symlink

### Step 3: Configure Environment

1. Edit `.env` file in cPanel File Manager or Terminal:
   ```bash
   nano .env
   ```
2. Update these settings for production:
   ```
   APP_ENV=production
   APP_DEBUG=false
   APP_URL=https://e-pos.cloud/demo
   
   DB_HOST=localhost
   DB_DATABASE=your_database_name
   DB_USERNAME=your_database_user
   DB_PASSWORD=your_database_password
   ```

### Step 4: Upload Missing Files

**Option A: Via FTP/SFTP**
1. Use FileZilla or similar FTP client
2. Connect to your cPanel FTP
3. Upload these folders from your local machine:
   - `public/uploads/` → `/home/cloudpos/public_html/demo/public/uploads/`

**Option B: Via cPanel File Manager**
1. Compress the `public/uploads/` folder locally into a zip file
2. Upload the zip file via cPanel File Manager
3. Extract it in the correct location

**Option C: Copy from Existing Demo Folder**
If the files already exist in the current demo folder:
```bash
# Backup current uploads
cp -r /home/cloudpos/public_html/demo_old/public/uploads/* /home/cloudpos/public_html/demo/public/uploads/
```

### Step 5: Install Dependencies (if not done by script)

```bash
cd /home/cloudpos/public_html/demo

# Install PHP dependencies
composer install --no-dev --optimize-autoloader

# If you have Node.js access, install and build assets
npm install
npm run production
```

### Step 6: Set Permissions

```bash
chmod -R 775 storage
chmod -R 775 bootstrap/cache
chmod -R 775 public/uploads
```

### Step 7: Run Migrations (if needed)

```bash
php artisan migrate --force
```

## Future Updates

To pull updates from GitHub:

1. In cPanel Git Version Control, click **Manage** on your repository
2. Click **Pull or Deploy** → **Update from Remote**
3. Run the setup script again if needed:
   ```bash
   cd /home/cloudpos/public_html/demo
   ./setup-cpanel.sh
   ```

## Important Notes

- **User uploads** (`public/uploads/`) must be backed up separately before pulling updates
- **Database** is not in Git - backup separately
- **`.env` file** is not in Git - must be configured manually on cPanel
- **Vendor folder** will be regenerated by Composer
- Always test in a staging environment first

## Troubleshooting

**Permission errors:**
```bash
chmod -R 775 storage bootstrap/cache public/uploads
chown -R username:username storage bootstrap/cache public/uploads
```

**Missing vendor folder:**
```bash
composer install --no-dev --optimize-autoloader
```

**Cache issues:**
```bash
php artisan config:clear
php artisan cache:clear
php artisan view:clear
php artisan route:clear
```

**Storage link missing:**
```bash
php artisan storage:link
```
